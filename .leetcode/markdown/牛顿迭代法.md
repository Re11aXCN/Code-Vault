牛顿迭代法（Newton's Method）是一种在实数域和复数域上**快速逼近方程根**的数值方法，也叫**牛顿-拉弗森方法**（Newton-Raphson Method）。

## 核心思想
通过**线性逼近**（切线）不断修正根的估计值，使其快速收敛到方程的真实解。

---

## 基本原理
对于方程$$ f(x) = 0$$：

1. **选择一个初始近似值** $$ x_0 $$（需要靠近真实根）
2. **迭代公式**：
   $$ x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)} $$
   其中 $$ f'(x_n) $$ 是 $$ f(x) $$ 在 $$ x_n $$ 处的导数。

---

## 几何解释
- 在点 $$ (x_n, f(x_n)) $$ 处作函数 $$ f(x) $$ 的切线
- 切线与 x 轴的交点就是新的近似值 $$ x_{n+1} $$
- 重复这个过程，逐步逼近函数的零点

---

## 收敛条件
1. 函数在根附近连续可导
2. 初始值 $$ x_0 $$ 足够接近真实根
3. $$ f'(x) $$ 在根处不为零
4. 通常具有**二次收敛速度**（每步误差平方级减少）

---

## 简单例子
求 $$ \sqrt{a} $$（即解方程 $$ x^2 - a = 0 $$：
- 迭代公式：$$ x_{n+1} = \frac{1}{2} ( x_n + \frac{a}{x_n}) $$
- 这就是著名的**巴比伦算法**

例如求 $$ \sqrt{2} $$：
```
x0 = 1.5
x1 = (1.5 + 2/1.5)/2 = 1.41666667
x2 = 1.41421569
x3 = 1.41421356  # 已很精确
```

---

## 优缺点
**优点**：
- 收敛速度快（二次收敛）
- 形式简单，易于实现

**缺点**：
- 需要计算导数
- 对初始值敏感，选择不当可能不收敛
- 遇到导数接近零的点可能失效
- 可能收敛到错误的根

---

## 实际应用
1. **工程计算**：电路分析、结构力学
2. **科学计算**：求解非线性方程
3. **计算机图形学**：光线追踪求交
4. **机器学习**：优化算法（如梯度下降的变种）
5. **金融**：计算内部收益率（IRR）

---

## 注意事项
- 实际应用中常结合**二分法**使用，保证收敛性
- 对于导数难以计算的情况，可使用**割线法**（用差商代替导数）
- 多根情况下需要谨慎选择初始值

# 牛顿迭代法求平方根的正确推导如下

牛顿迭代法是数值分析中最基础和重要的算法之一，体现了**用线性问题逼近非线性问题**的核心思想。

牛顿迭代法求平方根的正确推导如下：

设要求解的数为 $$ S $$（即 $$ \sqrt{S} $$），构造函数 $$ f(x) = x^2 - S $$，则方程 $$ f(x) = 0 $$ 的解即为 $$ \sqrt{S} $$。牛顿迭代公式为：
$$
x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}
$$

其中 $$ f'(x) = 2x  $$。代入得：
$$
x_{n+1} = x_n - \frac{x_n^2 - S}{2x_n} = \frac{2x_n^2 - (x_n^2 - S)}{2x_n} = \frac{x_n^2 + S}{2x_n} = \frac{1}{2} \left( x_n + \frac{S}{x_n} \right)
$$
此即  $$ x_{n+1} = \frac{1}{2} \left( x_n + \frac{\text{Num}}{x_n} \right)  $$，其中  $$ \text{Num} = S  $$。

---

### 关于初始值的收敛性分析

设真实值为 $$ X = \sqrt{\text{Num}} $$，并考虑初始值 $$ X_0 $$ 与 $$ X $$ 的关系：

**情况一：当 $$ X_0 > X $$ 时**

有不等式链：
$$
X \leq \frac{1}{2} \left( X_0 + \frac{\text{Num}}{X_0} \right) \leq X_0
$$

证明：
1. 右边不等式 $$ \frac{1}{2}(X_0 + \frac{\text{Num}}{X_0}) \leq X_0 $$
   - 化简得 $$ X_0 + \frac{\text{Num}}{X_0} \leq 2X_0 $$
   - 即 $$ \frac{\text{Num}}{X_0} \leq X_0 $$
   - 由于 $$ X_0 > X = \sqrt{\text{Num}} $$，有 $$ X_0^2 > \text{Num} $$，因此成立。

2. 左边不等式 $$ X \leq \frac{1}{2}(X_0 + \frac{\text{Num}}{X_0}) $$
   - 等价于 $$ 2X_0 X \leq X_0^2 + X^2 $$
   - 移项得 $$ 0 \leq X_0^2 - 2X_0 X + X^2 = (X_0 - X)^2 $$
   - 此式恒成立。

因此，当 $$ X_0 > X $$ 时，一次迭代后的值 $$ X_1 $$ 满足 $$ X \leq X_1 \leq X_0 $$，且每次迭代都会更接近 $$ X $$，直到满足精度要求。

**情况二：当 $$ X_0 < X $$ 时**

有：
$$
X_0 \leq X \leq \frac{1}{2} \left( X_0 + \frac{\text{Num}}{X_0} \right)
$$

证明：
1. 左边 $$ X_0 \leq X $$ 由假设成立。
2. 右边 $$ X \leq \frac{1}{2}(X_0 + \frac{\text{Num}}{X_0}) $$
   - 与情况一相同，等价于 $$ (X_0 - X)^2 \geq 0 $$，恒成立。

此时，经过一次迭代后得到的 $$ X_1 = \frac{1}{2}(X_0 + \frac{\text{Num}}{X_0}) $$ 将满足 $$ X_1 \geq X $$，即回到情况一。因此，无论初始值偏小还是偏大，牛顿迭代法都能收敛到平方根的真实值。